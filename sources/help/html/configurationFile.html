<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<title>The configuration file</title>
</head>

<body>
<h1><u>Form plugin</u></h1>
<h2><u>The configuration file</u></h2>
Please note than the plugin is able to handle several configuration files. As each configuration file is able to describe several forms, it is up to you to decide how you will organise your forms and how many configuration files you will create.

<h3 id="structure"><u>The file structure</u></h3>
<ul>
	<li><b><u>File content</u></b></li>
</ul>
<div style="margin-left:40px">
	The configuration files are <a href="http://www.json.org">JSON</a> files. This is a lightweight format that is easily read and written by humans and at the same time easily parsed by machines.<br>
	<br>
	It is built on two structures (comma separated):
	<ul>
		<li>A collection of objects (name/value pairs) between curly braces<br><div style="margin-left:40px"><img src="../img/json-object.png" width=400></div></li>
		<li>Arrays (ordered list of values) between brackets<br><div style="margin-left:40px"><img src="../img/json-array.png" width=400></div></li>
	</ul>
</div>
<br>
<ul>
	<li><b><u>File content validation</u></b></li>
</ul>
<div style="margin-left:40px">
</div>
	The library used to parse the configuration file does not allow to always retrieve the line numbers that hold errors. To help find errors, it is possible to use online JSON validators providing your JSON file and the following schema:
	<pre><code>
	{
	  "$schema": "http://json-schema.org/draft-04/schema#",
	  "description": "Schema for the Archi form plugin's configuration file",
	  "properties": {
	    "version": {
	      "description": "Version of the file structure",
	      "type": "integer"
	    },
	    "org.archicontribs.form": {
	      "description": "List of the forms",
	      "items": {
	        "properties": {
	          "name": {
	            "description": "Name of the form",
	            "type": "string"
	          },
	          "refers": {
	            "description": "Archi object the forms refers to",
	            "enum": [
	              "selected",
	              "view",
	              "model"
	            ],
	            "type": "string"
	          },
	          "filter": {
	            "properties": {
	              "genre": {
	                 "description": "genre of the filter",
	                 "enum": [
	                   "OR",
	                   "AND"
	                 ],
	                 "default": "AND",
	                 "type": "string"
	               },
	               "tests": {
	                 "items": {
	                    "properties": {
	                       "attibute": {
	                         "description": "value to test (can be a variable)",
	                           "type": "string"
	                       },
	                       "operation": {
	                         "description": "Operation of the test",
	                           "enum": [
	                             "exists",
	                             "equals",
	                             "iequals",
	                             "matches"
	                           ],
	                           "type": "string"
	                       },
	                       "value": {
	                         "type": "string"
	                       }
	                    },
	                    "required": [
	                      "attribute",
	                      "operation"
	                    ],
	                    "type": "object"
	                 },
	                 "type": "array"
	              },
	            },
	          },
	          "background": {
	            "description": "RGB values to define the background color of the form window",
	            "pattern": "\\d{1,3}, *\\d{1,3}, *\\d{1,3}",
	            "type": "string"
	          },
	          "height": {
	            "default": 600,
	            "description": "Height of the form window in pixels",
	            "type": "integer",
	            "minimum": 0
	          },
	          "width": {
	            "default": 850,
	            "description": "Width of the form window in pixels",
	            "type": "integer",
	            "minimum": 0
	          },
	          "spacing": {
	            "default": 4,
	            "description": "Spacing between graphical objects in the form window in pixels",
	            "type": "integer",
	            "minimum": 0
	          },
	          "buttonWidth": {
	            "default": 90,
	            "description": "Width of the Ok, Cancel and Export buttons",
	            "type": "integer",
	            "minimum": 0
	          },
	          "buttonHeight": {
	            "default": 25,
	            "description": "Height of the Ok, Cancel and Export buttons",
	            "type": "integer",
	            "minimum": 0
	          },
	          "buttonOk": {
	            "default": "Ok",
	            "description": "Label of the Ok button",
	            "type": "string"
	          },
	          "buttonCancel": {
	            "default": "Cancel",
	            "description": "Label of the Cancel button",
	            "type": "string"
	          },
	          "buttonExport": {
	            "default": "Export to Excel",
	            "description": "Label of the Export button",
	            "type": "string"
	          },
	          "tabs": {
	            "description": "List of tabs to create in the form window",
	            "items": {
	              "type": "object",
	              "properties": {
	                "name": {
	                  "description": "Name of the tab",
	                  "default": "(no name)",
	                  "type": "string"
	                },
	                "background": {
	                  "description": "RGB values to define the background color of the tab",
	                  "pattern": "\\d{1,3}, *\\d{1,3}, *\\d{1,3}",
	                  "default": "240, 240, 240",
	                  "type": "string"
	                },
	                "controls": {
	                  "description": "List of the controls to create in the tab",
	                  "items": {
	                    "properties": {
	                      "class": {
	                        "description": "Class of the control",
	                        "enum": [
	                          "check",
	                          "combo",
	                          "label",
	                          "table",
	                          "text"
	                        ],
	                        "type": "string"
	                      },
	                      "background": {
	                        "description": "RGB values to define the background color of the control",
	                        "pattern": "\\d{1,3}, *\\d{1,3}, *\\d{1,3}",
	                        "default": "240, 240, 240",
	                        "type": "string"
	                      },
	                      "foreground": {
	                        "description": "RGB values to define the foreground color of the control",
	                        "pattern": "\\d{1,3}, *\\d{1,3}, *\\d{1,3}",
	                        "default": "0, 0, 0",
	                        "type": "string"
	                      },
	                      "tooltip": {
	                        "description": "Tooltip when the mouse stands above the control",
	                        "type": "string"
	                      },
	                      "regexp": {
	                        "description": "Regexp to validate data entered =&gt; in text controls only",
	                        "type": "string"
	                      },
	                      "x": {
	                        "default": 0,
	                        "description": "The horizontal location of the control on the tab in pixels",
	                        "type": "integer",
	                        "minimum": 0
	                      },
	                      "y": {
	                        "default": 0,
	                        "description": "The vertical location of the control on the tab in pixels",
	                        "type": "integer",
	                        "minimum": 0
	                      },
	                      "width": {
	                        "description": "Width of the control in pixels",
	                        "type": "integer",
	                        "minimum": 0
	                      },
	                      "height": {
	                        "description": "Height of the control in pixels",
	                        "type": "integer",
	                        "minimum": 0
	                      },
	                      "text": {
	                        "description": "The text content of the control =&gt; when class is label only &lt;= can contain variables",
	                        "default": "",
	                        "type": "string"
	                      },
	                      "variable": {
	                        "description": "the variable to get the content from and to save the content to =&gt; when class is check, combo, or text",
	                        "type": "string"
	                      },
	                      "default": {
	                        "description": "default value to set in the control's text =&gt; when class is check, combo, or text",
	                        "type": "string"
	                      },
	                      "whenEmpty": {
	                        "description": "Action to do when the value is empty =&gt; when class is check, combo,  or text",
	                        "enum": [
	                          "ignore",
	                          "create",
	                          "delete"
	                        ]
	                      },
	                      "excelSheet": {
	                        "description": "Name of the Excel sheet where the content should be exported",
	                        "type": "string"
	                      },
	                      "excelCell": {
	                        "description": "Name of the Excel cell where the content should be exported",
	                        "type": "string"
	                      },
	                      "excelCellType": {
	                        "description": "Type of the Excel cell where the content should be exported",
	                        "enum": [
	                          "numeric",
	                          "string",
	                          "boolean",
	                          "formula",
	                          "blank"
	                        ]
	                      },
	                      "excelCellType": {
	                        "description": "Type of cell in case the value is empty (blank means an existing blank cell, zero means that we delete the cell if one exists)",
	                        "enum": [
	                          "blank",
	                          "zero"
	                        ]
	                      },
	                      "columns": {
	                        "description": "List of the columns of the control when the class is table",
	                        "items": {
	                          "properties": {
	                            "class": {
	                              "description": "Class of the cells in table column",
	                              "enum": [
	                                "check",
	                                "combo",
	                                "label",
	                                "text"
	                              ],
	                              "type": "string"
	                            },
	                            "tooltip": {
	                              "description": "Tooltip when the mouse stands above the table column",
	                              "type": "string"
	                            },
	                            "regexp": {
	                              "description": "Regexp to validate data entered in table columns of class text",
	                              "type": "string"
	                            },
	                            "width": {
	                              "description": "Width of the table column in pixels",
	                              "type": "integer",
	                              "minimum": 0
	                            },
	                            "excelcellcolumn": {
	                              "description": "Excel column where to export table column content",
	                              "type": "string"
	                            },
	                            "excelcelltype": {
	                              "description": "Type of the Excel cells when data is exported",
	                              "enum": [
	                                "blank",
	                                "boolean",
	                                "formula",
	                                "numeric",
	                                "string"
	                              ],
	                              "type": "string"
	                            },
	                            "exceldefault": {
	                              "description": "Type of cell in case the value is empty (blank means an existing blank cell, zero means that we delete the cell if one exists)",
	                              "enum": [
	                                "blank",
	                                "zero"
	                              ],
	                              "type": "string"
	                            }
	                          }
	                        },
	                        "required": [
	                          "class"
	                        ],
	                        "type": "array"
	                      },
	                      "lines": {
	                        "items": {
	                          "properties": {
	                            "generate": {
	                              "description": "Indicates if lines must be generated using the object children",
	                              "type": "boolean",
	                              "default": false
	                            },
	                            "cells": {
	                              "description": "Values of each cell, can contain variables",
	                              "type": "array"
	                            },
	                            "filter": {
	                              "properties": {
	                                "genre": {
	                                  "description": "genre of the filter",
	                                  "enum": [
	                                    "OR",
	                                    "AND"
	                                  ],
	                                  "default": "AND",
	                                  "type": "string"
	                                },
	                                "tests": {
	                                  "items": {
	                                    "properties": {
	                                      "attibute": {
	                                        "description": "value to test (can be a variable)",
	                                        "type": "string"
	                                      },
	                                      "operation": {
	                                        "description": "Operation of the test",
	                                        "enum": [
	                                          "exists",
	                                          "equals",
	                                          "iequals",
	                                          "matches"
	                                        ],
	                                        "type": "string"
	                                      },
	                                      "value": {
	                                        "type": "string"
	                                      }
	                                    },
	                                    "required": [
	                                      "attribute",
	                                      "operation"
	                                    ],
	                                    "type": "object"
	                                  },
	                                  "type": "array"
	                                }
	                              },
	                              "type": "object"
	                            }
	                          }
	                        },
	                        "type": "array",
	                        "required": [
	                          "category",
	                          "values"
	                        ]
	                      },
	                      "excelsheet": {
	                        "description": "Name of the Excel sheet to export to",
	                        "type": "string"
	                      },
	                      "excelcell": {
	                        "description": "Excell Cell reference when the class is label or text",
	                        "default": 0,
	                        "type": "integer",
	                        "minimum": 0
	                      },
	                      "excelfirstline": {
	                        "description": "Number of the first Excel row when the class is table",
	                        "default": 0,
	                        "type": "integer",
	                        "minimum": 0
	                      }
	                    },
	                    "type": "object",
	                    "required": [
	                      "class"
	                    ]
	                  },
	                  "type": "array"
	                }
	              }
	            },
	            "type": "array"
	          }
	        },
	        "type": "object",
	        "required": [
	          "name"
	        ]
	      },
	      "type": "array"
	    }
	  },
	  "required": [
	    "version",
	    "org.archicontribs.form"
	  ],
	  "type": "object"
	}
	</code></pre>
<h3 id="content"><u>The file content</u></h3>
The configuration file contains a JSON object (so begins and ends with curly braces) that contain (case insensitive):
<ul>
	<li><b>version</b>: [integer] must be 2 </li>
	<li><b>org.archicontribs.form</b>: [array] contains one JSON Object per form to create</li>
</ul>

<h4 id="forms">The forms</h4>
<div style="margin-left:40px">
	Each form can be parameterized using the following properties (case insensitive, mandatory mones are underlined):
	<ul>
		<li><b><u>Name</u></b>: [string] name of the form. This property is mandatory and can include variables.</li>
		<li><b>width</b>: [integer] width (in pixels) of the form window (default: 850)</li>
		<li><b>height</b>: [integer] height (in pixels) of the form window (default: 600)</li>
		<li><b>background</b>: [string] color of the form window background in RGB comma separated format (default: "240, 240, 240")</li>
		<li><b>spacing</b>: [integer] space in pixels between the form border and the controls in the form window (default: 4)</li>
		<li><b>buttonWidth</b>: [integer] width of the Ok, Cancel and Export buttons (default: 90)</li>
		<li><b>buttonHeight</b>: [integer] height of the Ok, Cancel and Export buttons (default: 25)</li>
		<li><b>buttonOk</b>: [string] text of the Ok button (default: "Ok")</li>
		<li><b>buttonCancel</b>: [string] text of the Cancel button (default: "Cancel")</li>
		<li><b>buttonExport</b>: [string] text of the Export button (default: "Export to Excel")</li>
		<li><b>refers</b>: [string] indicates to which component the form refers to (default: "selected"):
		<ul>
			<li><b>selected</b>: : the form refers to any selected object in the view. In this case, the number of menu entries is limited to 5 per form.</li>
			<li><b>view</b>: the form refers to the view itself. In this case, only one menu entry is shown per form even if several objects are selected in the view.</li>
			<li><b>model</b>: the form refers to the model. In this case, only one menu entry is shown per form even if several objects are selected in the view.</li>
		</ul></li>
		<li><b>filter</b>: [array] allow to <a href="#filters">filter</a> the objects the form applies to</li>
		<li><b>whenEmpty</b>: [string] default behaviour when the plugin is required to save an <a href="#whenEmpty">empty value</a> into a <a href="#variable">variable</a></li>
		<li><b><u>tabs</u></b>: [array] list of the <a href="#tabs">tab</a> to create. At least, one <a href="#tabs">tab</a> must be created.</li>
	</ul>
	<br>
	<ul>
		<li><b><u>The Archi's component referred by the form</u></b>
	</ul>
	<div style="margin-left:40px">
		Please note that every form always refer to one (and only one) Archi component. Depending on the configuration file, this Archi component can be:
		<ul>
			<li>The component that is selected in Archi (a graphical object, an element, a relationship, a view, a folder or even the model itself),</li>
			<li>The component's view (if it is a graphical object),</li>
			<li>The component's folder (if it is an element or a relationship),</li>
			<li>The whole model.</li>
		</ul>
		By default, all the <a href="#variables">variables</a> used in the form will refer to this component.
	</div>
	<br>
	<ul>
		<li><b><u>Example</u></b></li>
	</ul>
	<div style="margin-left:40px">
		As an example, the following file creates two empty forms with the same name. The first one will apply to the view where the right-click took place, and the second one will apply to the selected objects in the view (if any):
		<pre><code>
{
    "version": 2,
    "org.archicontribs.form": [
        {
            "name": "Form test for ${class) \"${name}\"",
            "width": 900,
            "height": 400,
            "spacing": 4,
            "background": "250, 250, 250",
            "refers": "view",
            "tabs": []
        },
        {
            "name": "Form test for ${class) \"${name}\"",
            "width": 800,
            "height": 600,
            "spacing": 4,
            "background": "255, 255, 255",
            "refers": "selected",
            "tabs": []
        }
    ]
}
		</code></pre>
	</div>
</div>

<h4 id="tabs">The tabs</h4>
<div style="margin-left:40px">
	Each form is compound of tabs (at lease one) that will show up the <a href="#controls">controls</a>.

	Each tab might have the following properties (case insensitive, mandatory ones are underlined):
	<ul>
		<li><b>name</b>: [string] name of the tab (default: "(no name)")</li>
		<li><b>background</b>: [string] color of the form window background in RGB comma separated format (default: "240, 240, 240")</li>
		<li><b><u>controls</u></b>: [array] list of the <a href="#controls">controls</a> to show up</li>
	</ul>
	<br>
	<ul>
		<li><b><u>Example</u></b></li>
	</ul>
	<div style="margin-left:40px">
		The following file creates a form that applies to the view where the right-click take"s place, and in this form, creates 3 tabs:
		<pre><code>
{
    "org.archicontribs.form": [
        {
            "name": "Form test for ${class} \"${name}\"",
	    "refers": "view",
            "width": 900,
            "height": 400,
            "spacing": 4,
            "background": "250, 250, 250",
            "whenEmpty": "ignore",
            "tabs": [
                {
                    "name": "View information",
                    "background": "225, 225, 225",
                    "controls": []
                },
                {
                    "name": "Elements in the view",
                    "background": "200, 200, 200",
                    "controls": []
                },
                {
                    "name": "Relationships in the view",
                    "background": "200, 200, 200",
                    "controls": []
                }
            ]
        }
    ]
}
		</code></pre>
	</div>
</div>

<h4 id="controls">The controls</h4>
<div style="margin-left:40px">
	Each tab contains <a href="#controls">controls</a> (at lease one) that will allow to show up (and possibly) update Archi properties.<br>
	<br>
	Each object might have the following properties (case insensitive, mandatory ones are underlined):
	<ul>
		<li><b><u>class</u></b>: [string] class of the graphical object (mandatory). It must be one of:
		<ul>
		  <li><b>label</b>: read only text string</li>
		  <li><b>text</b>: update-able text string</li>
		  <li><b>combo</b>: list of acceptable values</li>
		  <li><b>check</b>: check button to specify binary values (like true/false, yes/no, ...)</li>
		  <li><b>table</b>: create a <a href="#tables">table</a> with one line per element and relationship in the view</li>
		</ul>
		<li><b>x</b>: [integer] horizontal position, in pixels, of the control (0 is left)</li>
		<li><b>y</b>: [integer] vertical position, in pixels, of the control (0 is top)</li>
		<li><b>width</b>: [integer] width (in pixels) of the control (default: calculated from the content)</li>
		<li><b>height</b>: [integer] height (in pixels) of the form window (default: calculated from the content)</li>
		<li><b>background</b>: [string] color of the object background in RGB comma separated format (default: "240, 240, 240")</li>
		<li><b>foreground</b>: [string] color of the text color in the object in RGB comma separated format (default: "0, 0, 0")</li>
		<li><b>tooltip</b>: [string] text shown up when you hover the object with your mouse (default is no tooltip if regexp is not specified, default to the regexp if specified)</li>
		<li><b>regexp</b>: [string] (for text controls only) allow to specify a regexp that will change the foreground color of the text: red if the regexp is not matched, green if the regexp is matched.</li>
		<li><b>text</b>: [string] (for label controls only)<a href="#variables">literal</a> string to print in the control</li>
		<li><b>values</b>: [array] list of valid values for combo and check objects.</li>
		<li><b><u>variable</u></b>: [string] (for text, combo and check controls) <a href="#variables">variable</a> to link to to the object</li>
		<li><b>default</b> [string] (in conjunction with "variable" only) specifies the default value if the <a href="#variables">variable</a> has got an empty value</li>
		<li><b>forceDefault</b> [boolean] (in conjunction with "variable" only) forces the default value even if the <a href="#variables">variable</a> is not empty</li>
		<li><b>whenEmpty</b> [string] (in conjunction with "<a href="#variables">variable</a>" only) specifies what to do when saving the <a href="#variables">variable</a> value back to the Archi component, if the <a href="#variables">variable</a> is empty. It is usually used when the variable is an Archi property. It may be one of:
		<ul>
			<li><b>ignore</b>: do not save the Archi property and leave the component untouched: If the Archi property was existing, is keeps its value. If the Archi property did not exist, it is not created.</li>
			<li><b>create</b>: creates the Archi property with an empty value</li>
			<li><b>delete</b>: If the Archi property was existing, deletes it.</li>
		</ul></li>
	</ul>  
	<br>

	<ul>
		<li><b><u>Example</u></b></li>
	</ul>
	<div style="margin-left:40px">
		The following file fills the tabs with label, text and combo controls:<br>
		<pre><code>
{
    "version": 2,
    "org.archicontribs.form": [
        {
            "name": "Form test for ${class} \"${name}\"",
            "refers": "view",
            "width": 900,
            "height": 400,
            "spacing": 4,
            "background": "250, 250, 250",
            "whenEmpty": "ignore",
            "tabs": [
                {
                    "name": "View information",
                    "background": "225, 225, 225",
                    "controls": [
                        {
                            "class": "label",
                            "x": 10,
                            "y": 10,
                            "width": 100,
                            "height": 20,
                            "background": "225, 225, 225",
                            "foreground": "0, 0, 0",
                            "tooltip": "Name of the Archi component",
                            "fontName": "Arial",
                            "fontSize": 12,
                            "fontBold": false,
                            "fontItalic": false,
                            "text": "Name"
                        },
                        {
                            "class": "label",
                            "x": 120,
                            "y": 10,
                            "width": 300,
                            "height": 20,
                            "background": "225, 225, 225",
                            "foreground": "250, 56, 56",
                            "tooltip": "Name of the Archi component",
                            "fontName": "Times New Roman",
                            "fontSize": 12,
                            "fontBold": true,
                            "fontItalic": false,
                            "text": "${name}"
                        },
                        {
                            "class": "label",
                            "x": 10,
                            "y": 40,
                            "width": 100,
                            "height": 20,
                            "background": "225, 225, 225",
                            "foreground": "0, 0, 0",
                            "tooltip": "Class of the Archi component",
                            "fontName": "Arial",
                            "fontSize": 12,
                            "fontBold": false,
                            "fontItalic": false,
                            "text": "Class"
                        },
                        {
                            "class": "label",
                            "x": 120,
                            "y": 40,
                            "width": 300,
                            "height": 20,
                            "background": "225, 225, 225",
                            "foreground": "250, 56, 56",
                            "tooltip": "Class of the Archi component",
                            "fontName": "Times New Roman",
                            "fontSize": 12,
                            "fontBold": true,
                            "fontItalic": false,
                            "text": "${class}"
                        },
                        {
                            "class": "label",
                            "x": 10,
                            "y": 70,
                            "width": 100,
                            "height": 20,
                            "background": "225, 225, 225",
                            "foreground": "0, 0, 0",
                            "tooltip": "What the view describes",
                            "fontName": "Arial",
                            "fontSize": 12,
                            "fontBold": false,
                            "fontItalic": false,
                            "text": "Describes"
                        },
                        {
                            "class": "combo",
                            "x": 120,
                            "y": 70,
                            "width": 200,
                            "height": 20,
                            "background": "225, 225, 225",
                            "foreground": "250, 56, 56",
                            "tooltip": "What the view describes",
                            "fontName": "Times New Roman",
                            "fontSize": 12,
                            "fontBold": true,
                            "fontItalic": false,
                            "values": ["the past", "the present", "the future"],
                            "variable": "${property:describes}",
                            "default": "the present",
                            "editable": true,
                            "whenEmpty": "delete"
                        },
                        {
                            "class": "label",
                            "x": 10,
                            "y": 100,
                            "width": 100,
                            "height": 20,
                            "background": "225, 225, 225",
                            "foreground": "0, 0, 0",
                            "tooltip": "Language",
                            "fontName": "Arial",
                            "fontSize": 12,
                            "fontBold": false,
                            "fontItalic": false,
                            "text": "Language",
                        },
                        {
                            "class": "combo",
                            "x": 120,
                            "y": 100,
                            "width": 200,
                            "height": 20,
                            "background": "225, 225, 225",
                            "foreground": "250, 56, 56",
                            "tooltip": "Language",
                            "fontName": "Times New Roman",
                            "fontSize": 12,
                            "fontBold": true,
                            "fontItalic": false,
                            "values": ["_fr", "_en"],
                            "variable": "${property:language}",
                            "default": "fr",
                            "tag": "language",
                            "editable": false,
                            "whenEmpty": "delete"
                        },
                        {
                            "class": "label",
                            "x": 10,
                            "y": 135,
                            "width": 100,
                            "height": 20,
                            "background": "0, 0, 0",
                            "foreground": "255, 255, 255",
                            "tooltip": "Comment",
                            "fontName": "Arial",
                            "fontSize": 12,
                            "fontBold": false,
                            "fontItalic": false,
                            "text": "Comment"
                        },
                        {
                            "class": "text",
                            "x": 120,
                            "y": 130,
                            "width": 750,
                            "height": 100,
                            "background": "225, 225, 225",
                            "foreground": "250, 56, 56",
                            "tooltip": "Please specify a comment",
                            "fontName": "Times New Roman",
                            "fontSize": 12,
                            "fontBold": true,
                            "fontItalic": false,
                            "variable": "${property:comment}",
                            "default": "$property:comment$[language]}",
                            "forceDefault": true,
                            "editable": false,
                            "regexp": ".*",
                            "whenEmpty": "delete"
                        }
                    ]
                },
                {
                    "name": "Elements in the view",
                    "background": "200, 200, 200",
                    "controls": []
                },
                {
                    "name": "Relationships in the view",
                    "background": "200, 200, 200",
                    "controls": []
                }
            ]
        }
    ]
}
		</code></pre>
	</div>
</div>

<h4 id="tables">The tables</h4>
<div style="margin-left:40px">
	In addition to simple controls, tabs can also contain tables which can organise controls in rows and columns (case insensitive, the mandatory ones are underlined):
	<ul>
		<li><b>x</b>: [integer] horizontal position, in pixels, of the table (0 is left)</li>
		<li><b>y</b>: [integer] vertical position, in pixels, of the table (0 is top)</li>
		<li><b>width</b>: [integer] width (in pixels) of the table (default: calculated from the content)</li>
		<li><b>height</b>: [integer] height (in pixels) of the table (default: calculated from the content)</li>
		<li><b>background</b>: [string] color of the object backgroung in RGB comma separated format (default: "240, 240, 240")</li>
		<li><b>foreground</b>: [string] color of the text color in the object in RGB comma separated format (default: "0, 0, 0")</li>
		<li><b>tooltip</b>: [string] text shown up when you hover the object with your mouse</li>
		<li><b><u>columns</u></b>: [array] describe the table columns</li>
		<li><b><u>lines</u></b>: [array] describe the table lines</li>
	</ul>
	
	<ul>
		<li><b><u>Table columns</u></b></li>
	</ul>
	<div style="margin-left:40px">
		The table columns properties are (case insensitive, the mandatory ones are underlined):
		<ul>
			<li><b>name</b>: [string] name of the column used for the column header</li>
			<li><b><u>class</u></b>: [string] class of the cells in the column. Must be one of label, text, combo or check.</li>
			<li><b>tooltip</b>: [string] text shown up when you hover the object with your mouse (default is no tooltip if regexp is not specified, default to the regexp if specified)</li>
			<li><b>regexp</b>: [string] (for text columns only) allow to specify a regexp that will change the foreground color of the text:
			<ul>
				<li>red if the regexp is not matched,</li>
				<li>green if the regexp is matched.</li>
			</ul></li>
			<li><b>text</b>: [string] (for label controls only) literal string to print in the control</li>
			<li><b>values</b>: [array] list of valid values for combo and check controls.</li>
			<li><b><u>variable</u></b>: [string] (for text, combo and check controls) <a href="#variables">variable</a> to link to the object</li>
			<li><b>default</b>: [string] (in conjunction with the "variable" property only) defines the default value of the <a href="#variables">variable</a></li>
			<li><b>whenEmpty</b>: [string] (in conjunction with the "variable" property only) defines what to do during the "save" operation when the value is empty</li>
		</ul>
	</div>
	
	<ul>
		<li><b><u>Table lines</u></b>
	</ul>
	<div style="margin-left:40px">
		the table lines properties are (case insensitive, the mandatory ones are underlined):
		<ul>
			  <li><b><u>cells</u></b>: [array] this property must contain one literal or <a href="#variables">variable</a> per column. If the corresponding column contains a label, then the literal or <a href="#variables">variable</a> content is set as the label's "text" property. In case of a text, combo or check control, then the <a href="#variables">variable</a> is set to the control's <a href="#variables">variable</a> property.</li>
			  <li><b>generate</b>: [boolean] must be yes or no.
			  <ul>
			  	<li>When the <b>generate</b> property is <b>not set</b> or is set to <b>false</b>, then a single line is created and the <a href="#variables">variable</a> refer to the form's selected object.</li>
			  	<li>When the <b>generate</b> property is set to <b>true</b>, then one line is generated per child of the form's selected object.</li>
			  </ul></li>
			  <li><b>filter</b>: [JSON object] (used with generated lines only) allow to <a href="#filters">filter</a> the children to add in the table</li>
		</ul>
	</div>
	
	<ul>
		<li><b><u>Example</u></b></li>
	</ul>
	<div style="margin-left:40px">
		In the following example we suppose that the form refers to a view, the table will contain one line per element in the view:<br>
		<pre><code>
{
    "class": "table",
    "x": 10,
    "y": 10,
    "width": 870,
    "height": 300,
    "background": "200, 200, 200",
    "foreground": "0, 0, 0",
    "tooltip": "This table contains all the elements present in the view",
    "excelSheet": "elements",
    "excelFirstLine": 1,
    "columns": [
        {"name": "Class",         "ExcelColumn": "A",  "excelCellType": "String", "excelDefault": "zero", "width": 200,  "class": "label",  "fontItalic": true },
        {"name": "Name",          "ExcelColumn": "B",  "excelCellType": "String", "excelDefault": "zero", "width": 200,  "class": "text"    "fontBold": true   },
        {"name": "Describes",     "ExcelColumn": "C",  "excelCellType": "String", "excelDefault": "zero", "width": 400,  "class": "combo",  "values": ["the past", "the present", "the future"],  "fontSize": 11  },
    ],
    "lines": [
        {
            "generate": true,
            "cells": ["${class}", "${name}", "${property:describes}"],
            "filter": {
                "genre": "OR",
                "tests": [
                    { "attribute": "${class}", "operation": "iequals", "value": "Capability" },
                    { "attribute": "${class}", "operation": "iequals", "value": "CourseOfAction" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Resource" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Product" },
                    { "attribute": "${class}", "operation": "matches", "value": "Business.*" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Contract" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Representation" },
                    { "attribute": "${class}", "operation": "iequals", "value": "DataObject" },
                    { "attribute": "${class}", "operation": "matches", "value": "Application.*" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Artifact" },
                    { "attribute": "${class}", "operation": "matches", "value": "Technology.*" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Node" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Device" },
                    { "attribute": "${class}", "operation": "iequals", "value": "SystemSoftware" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Path" },
                    { "attribute": "${class}", "operation": "iequals", "value": "CommunicationNetwork" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Material" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Equipment" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Facility" },
                    { "attribute": "${class}", "operation": "iequals", "value": "DistributionNetwork" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Workpackage" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Deliverable" },
                    { "attribute": "${class}", "operation": "iequals", "value": "ImplementationEvent" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Plateau" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Gap" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Stakeholder" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Driver" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Assessment" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Goal" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Outcome" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Principle" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Requirement" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Constraint" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Meaning" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Value" },
                    { "attribute": "${class}", "operation": "iequals", "value": "Location" }
                ]
            }
        }
    ]
}
		</code></pre>

		And this one will contain one line per relationship in the view:<br>
		<pre><code>
{
    "class": "table",
    "x": 10,
    "y": 10,
    "width": 870,
    "height": 300,
    "background": "200, 200, 200",
    "foreground": "0, 0, 0",
    "tooltip": "This table contains all the relationships present in the view",
    "excelSheet": "relationships",
    "excelFirstLine": 1,
    "columns": [
        {"name": "Class",         "ExcelColumn": "A",  "excelCellType": "String", "excelDefault": "zero", "width": 200,  "class": "label" },
        {"name": "Name",          "ExcelColumn": "B",  "excelCellType": "String", "excelDefault": "zero", "width": 200,  "class": "text"  },
        {"name": "Describes",     "ExcelColumn": "C",  "excelCellType": "String", "excelDefault": "zero", "width": 400,  "class": "combo",  "values": ["the past", "the present", "the future"]  },
    ],
    "lines": [
        {
            "generate": true,
            "cells": ["${class}", "${name}", "${property:describes}"],
            "filter": {
                "tests": [
                    { "attribute": "${class}", "operation": "matches", "value": ".*Relationship" }
                ]
            }
        }
    ]
}
		</code></pre>
	</div>
</div>

<h4 id="variables">The variables</h4>
<div style="margin-left:40px">
	<ul>
		<li><b><u>literals vs variables</u></b></li>
	</ul>
	<div style="margin-left:40px">
		Controls can show up:
		<ul>
			<li><b>literals</b>: any text that doesn't start with a dollar sign. As any string in JSON, they must also be enclosed with quotes. They are typically used in "text" property of the label controls, or "default" property of other controls.</li>
		</ul>
		<pre><code>
"this is a literal"
		</code></pre>
	
		<ul>
			<li><b>variables</b>: start with a dollar sign and are enclosed with curly braces and can be nested. As any string in JSON, they must also be enclosed with quotes.</li>
		</ul>
		<pre><code>
"${class}"
"${view:documentation}"
"${model:name}"
"${property:documentation_${model:property:language}}"
		</code></pre>
		
		<ul>
			<li><b>mix</b>: It is possible to mix literals and variable in read-only controls like labels. Obviously, this is not possible in "variable" fields of updatable controls like text, combo or check.</li>
		</ul>
		<pre><code>
"Test form for ${class} \"${name}\""
		</code></pre>
	</div>
	
	<ul>
		<li><b><u>Use of variables</u></b>
	</ul>
	<div style="margin-left:40px">
		Variables can be used in all the controls (label, text, combo, check, table) to access information about the Archi component that the form refers to. The following variables can be used:
		<ul>
			<li><b>${class}</b> [read only] class of the component</li>
			<li><b>${name}</b> [read/write] name of the component</li>
			<li><b>${documentation}</b> [read/write] documentation of the component</li>
			<li><b>${property:xxxxx}</b> [read/write] property xxxxx of the component</li>
		</ul>
	</div>
	
	<ul>
		<li><b><u>Variables scope</u></b>
	</ul>
	<div style="margin-left:40px">
		It is also possible to access information about a parent of the Archi component that the form refers to, by adding a variable scope as prefix:
		<ul>
			<li><b>view</b>: when the Archi component is a graphical object, then it is possible to access information about the view containing this graphical object, for instance:
			<ul>
				<li><b>${view:class}</b> [read only] class of the view</li>
				<li><b>${view:name}</b> [read/write] name of the view</li>
				<li><b>${view:documentation}</b> [read/write] documentation of the view</li>
				<li><b>${view:property:xxxxx}</b> [read/write] property xxxxx of the view</li>
			</ul></li>
			<li><b>model</b>: it is possible to access information about the model that contains the Archi component.
			<ul>
				<li><b>${model:class}</b> [read only] class of the model</li>
				<li><b>${model:name}</b> [read/write] name of the model</li>
				<li><b>${model:documentation}</b> [read/write] documentation of the model</li>
				<li><b>${model:property:xxxxx}</b> [read/write] property xxxxx of the model</li>
			</ul></li>
		</ul>
	</div>
		
	<ul>
		<li id="whenEmpty"><b><u>Variables values</u></b>
	</ul>
	<div style="margin-left:40px">
		The variables values are set using information from the corresponding Archi component. Nevertheless, it is possible to change the variable behaviour when reading or writing value. This is usually used in conjunction with Archi properties:
		<ul>
			<li><b>default</b>: this property allows to set a default value when the corresponding Archi component's information is not set or has got an empty value.
			<li><b>forceDefault</b>: force the default value, even if the corresponding Archi component's information is set and has got a non empty value.
			<li><b>whenEmpty</b>: indicates what to do when the value to store in the corresponding Archi component is empty:
			<ul>
				<li><b>ignore</b>: do not save the Archi property and leave the component untouched: If the Archi property was existing, is keeps its value. If the Archi property did not exist, it is not created.
				<li><b>create</b>: creates the Archi property with an empty value
				<li><b>delete</b>: If the Archi property exists, deletes it.
			</ul></li>
	  </ul>
	</div>
</div>

<h4 id="excel">Exporting to Excel</h4>
<div style="margin-left:40px">
	Every controls can be exported into an Excel spreadsheet. When the "Export to Excel" button is pressed, then a popup asks for the name of the Excel spreadsheet.<br>
	<br>
	<i>Please note that the "Export to Excel" button will be show only if at least one control has got the required field. Else, the button will remain hidden.</i>  
	<br>
	<u>For simple controls</u>, just provide the following properties (case insensitive, the mandatory ones are underlined). If the properties are not specified, then the control will just be ignored during the export to Excel process.
	<ul>
		<li><b><u>excelSheet</u></b> [string] the name of the tab in the Excel file</li>
		<li><b><u>excelCell</u></b> [string] reference of the cell in the Excel sheet. It can be any specified in any syntax allowed by Excel like "D9" or "$D$9" or any cell name recorded in the sheet.</li>
		<li><b>excelCellType</b> [string] type of Excel cell. Must be one of:
		<ul>
			<li><b>string</b> (the default)</li>
			<li><b>boolean</b></li>
		 	<li><b>numeric</b></li>
			<li><b>formula</b></li>
		</ul></li>
		<li><b>excelDefault</b> [string] specifies what to do if the value to export to Excel is null (case of a property that has not been created for example). Must be one of:
		<ul>
			<li><b>blank</b>: the cell will be blanked (the default)</li>
			<li><b>zero</b>: the cell will contain a 0 in numeric cells, an empty string in string and formula cells and false in boolean cells</li>
		</ul></li>
	</ul>
	
	<u>For tables</u>, the following properties must be provided <u>in the "table" section</u>:
	<ul>
		<li><b><u>excelSheet</u></b> [string] the name of the tab in the Excel file</li>
		<li><b><u>excelFirstLine</u></b> [integer] number of the first Excel line where the table lines must be inserted</li>
	</ul>
		
	In addition, the following property must be provided <u>in the "column" section</u>:
	<ul>
		<li><b><u>excelColumn</u></b>: [string] reference of the Excel column.</li>
		<li><b>excelCellType</b>: [string] type of Excel cell. Must be one of:
		<ul>
			<li><b>string</b> (the default)</li>
			<li><b>boolean</b></li>
		 	<li><b>numeric</b></li>
			<li><b>formula</b></li>
		</ul></li>
		<li><b>excelDefault</b>: [string] specifies what to do if the value to export to Excell is null (case of a property that has not been created for example). Must be one of:
		<ul>
			<li><b>blank</b>: the cell will be blanked (the default)</li>
			<li><b>zero</b>: the cell will contain a 0 in numeric cells, an empty string in string and formula cells and false in boolean cells</li>
		</ul></li>
	</ul>
</div>

<h4 id="filters">The filters</h4>
<div style="margin-left:40px">
	Filters can be used at two locations:
	<ul>
		<li>in the form definition itself (the <b>org.archicontribs.form</b> object)</li>
		<li>in the generated table lines (the <b>lines</b> object)</li>
	</ul>
	<br>
	The filters are compound of:
	<ul>
		<li><b>tests</b>: [array] array of individual tests
		<ul>
		  <li><b>attribute</b>: [string] and literral, variable or mix</li>
		  <li><b>value</b>: [string] value to compare the attribute with, using the following operation.</li>
		  <li><b>operation</b>: [string] operation to be done on the attribute. Can be one of:
		  <ul>
		  	<li><b>exists</b>: checks if the attribute exists (usually used in conjunction with Archi properties)</li>
		  	<li><b>equals</b>: compares the attribute to its value (case sentitive)</li>
		    <li><b>iequals</b>: compares the attribute to its value (case insentitive) </li>
		    <li><b>matches</b>: checks if the attribute matches the regexp given as value</li>
		  </ul>
		</ul></li>
		<li><b>genre</b>: [string] Spcify how to combine the individual tests. Can be one of:
		<ul>
		  <li><b>OR</b>: the test is positive if at lease one of the individual tests is positive</li>
		  <li><b>AND</b>: the test is positive if all the individual tests are positive</li>
		</ul></li>
	</ul>
	<br>
</div>
<ul>
	<li><b><u>Examples</u></b></li>
</ul>
<div style="margin-left:40px">
	the following filter may be used to retreive all the Archi elements (but not the relationships):
	<pre><code>
"filter": {
    "genre": "OR",
    "tests": [
        { "attribute": "${class}", "operation": "iequals", "value": "Capability" },
        { "attribute": "${class}", "operation": "iequals", "value": "CourseOfAction" },
        { "attribute": "${class}", "operation": "iequals", "value": "Resource" },
        { "attribute": "${class}", "operation": "iequals", "value": "Product" },
        { "attribute": "${class}", "operation": "matches", "value": "Business.*" },
        { "attribute": "${class}", "operation": "iequals", "value": "Contract" },
        { "attribute": "${class}", "operation": "iequals", "value": "Representation" },
        { "attribute": "${class}", "operation": "iequals", "value": "DataObject" },
        { "attribute": "${class}", "operation": "matches", "value": "Application.*" },
        { "attribute": "${class}", "operation": "iequals", "value": "Artifact" },
        { "attribute": "${class}", "operation": "matches", "value": "Technology.*" },
        { "attribute": "${class}", "operation": "iequals", "value": "Node" },
        { "attribute": "${class}", "operation": "iequals", "value": "Device" },
        { "attribute": "${class}", "operation": "iequals", "value": "SystemSoftware" },
        { "attribute": "${class}", "operation": "iequals", "value": "Path" },
        { "attribute": "${class}", "operation": "iequals", "value": "CommunicationNetwork" },
        { "attribute": "${class}", "operation": "iequals", "value": "Material" },
        { "attribute": "${class}", "operation": "iequals", "value": "Equipment" },
        { "attribute": "${class}", "operation": "iequals", "value": "Facility" },
        { "attribute": "${class}", "operation": "iequals", "value": "DistributionNetwork" },
        { "attribute": "${class}", "operation": "iequals", "value": "Workpackage" },
        { "attribute": "${class}", "operation": "iequals", "value": "Deliverable" },
        { "attribute": "${class}", "operation": "iequals", "value": "ImplementationEvent" },
        { "attribute": "${class}", "operation": "iequals", "value": "Plateau" },
        { "attribute": "${class}", "operation": "iequals", "value": "Gap" },
        { "attribute": "${class}", "operation": "iequals", "value": "Stakeholder" },
        { "attribute": "${class}", "operation": "iequals", "value": "Driver" },
        { "attribute": "${class}", "operation": "iequals", "value": "Assessment" },
        { "attribute": "${class}", "operation": "iequals", "value": "Goal" },
        { "attribute": "${class}", "operation": "iequals", "value": "Outcome" },
        { "attribute": "${class}", "operation": "iequals", "value": "Principle" },
        { "attribute": "${class}", "operation": "iequals", "value": "Requirement" },
        { "attribute": "${class}", "operation": "iequals", "value": "Constraint" },
        { "attribute": "${class}", "operation": "iequals", "value": "Meaning" },
        { "attribute": "${class}", "operation": "iequals", "value": "Value" },
        { "attribute": "${class}", "operation": "iequals", "value": "Location" }
    ]
}
	</code></pre>
	<br>
	The following filter may be used to retrieve all the relationships:
	<pre><code>
"filter": {
    "tests": [
        { "attribute": "${class}", "operation": "matches", "value": ".*Relationship" }
    ]
}
	</code></pre>
	<br>
	The following filter may be used to retrieve all the nodes that have got a non null name:
	<pre><code>
"filter": {
    "genre": "AND",
    "tests": [
        { "attribute": "${class}", "operation": "equals", "value": "Node" },
        { "attribute": "${name}", "operation": "matches", "value": ".+" }
    ]
}
	</code></pre>
</div>

</body>
</html>